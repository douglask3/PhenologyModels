##########################################################################################
## cfg                                                                                  ##
##########################################################################################
source("cfg.r")
source("springDynamics.r")


##########################################################################################
## Set up parameters                                                                    ##
##########################################################################################
## For plot
cols=c("green","brown","yellow","blue","cyan","cyan",'cyan')
ltys=c(1,1,1,1,2,3,4)

## Data
source("find_Fe_function.R")
force.env <-ecdata[,c('SWC10','NDVI250X')]

force.env$Fe=predict(res.sig,list(SWC10=force.env$SWC10))

browser()


##########################################################################################
## Open Figure                                                                          ##
##########################################################################################
pdf("figs/PhenologyFit.pdf",height=18,width=18)

###########################################################################################
## Fit and plot                                                                          ##
###########################################################################################
nls(NDVI250X ~ springDynamics(Fe,r,d),start=list(r=1,d=1),data=force.env)

## For each spring type, run 4 tests:
dev.off()
